(()=>{var w=r=>{let s=r.slice().sort((o,e)=>o-e),n=Math.floor(s.length/2);return s.length%2!==0?s[n]:(s[n-1]+s[n])/2},y=onmessage=async({data:r})=>{importScripts(r.urls.urlScoringScript,r.urls.urlTemplatingScript);let{testee:s,session:n,questionnaire:{questionnaireId:o,answers:e},urls:{urlReportTemplate:l,urlQuestionnaireSpecs:p}}=r,c=Object.keys(e),u=c.map(t=>e[t].answerLatency),m=w(u);c.forEach(t=>{e[t].deltaAnswerLatency=e[t].answerLatency-m});let[h,a]=await Promise.all([fetch(l).then(t=>t.text()),fetch(p).then(t=>t.json())]),i=Object.keys(a).length>0?computeScores({testee:s,session:n,answers:e,specs:a}):{},g=generateReport({testee:s,session:n,answers:e,scores:i,template:h});postMessage({questionnaireId:o,questionnaireScores:i,questionnaireAnswers:e,questionnaireReport:g})};})();
